# ===================================================
# dbt Project Configuration
# ===================================================
# Mục đích: Định nghĩa cấu trúc và behavior của dbt project
# ===================================================

name: 'sme_pulse'
version: '1.0.0'
config-version: 2

# Profile name phải khớp với tên trong profiles.yml
profile: 'sme_pulse'

# Đường dẫn tới thư mục models
model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

# Thư mục output
target-path: "target"
clean-targets:
  - "target"
  - "dbt_packages"

# ===== CẤU HÌNH SEEDS =====
seeds:
  sme_pulse:
    +schema: silver                   # Seeds vào silver schema
    +database: sme_lake               # Unified catalog

# ===== CẤU HÌNH MODELS =====
models:
  sme_pulse:
    # Silver models (staging/core)
    silver:
      +materialized: table
      +schema: silver                 # silver schema
      +database: sme_lake             # unified catalog
      # Disable external models with missing source data
      external:
        stg_wb_indicators:
          +enabled: false  # World Bank data not ingested yet
      # Disable feature models that depend on disabled staging models
      features:
        ftr_macroeconomic:
          +enabled: false  # Depends on stg_wb_indicators
    # Gold models
    gold:
      +materialized: table
      +schema: gold                   # gold schema
      +database: sme_lake             # unified catalog
      external:
        dim_macro_indicators:
          +enabled: false  # Depends on stg_wb_indicators

# ===== VARIABLES =====
vars:
  # Watermark để track last processed timestamp
  start_date: '2025-01-01'
  
  # Organization filter (multi-tenant)
  default_org_id: 'org-sme-001'
